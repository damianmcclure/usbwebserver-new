<?php

	//supported characters
	$a = 'ABCDEFGHIJLMNOPQRSTUVWXYZabcdefghijlmnopqrstuvwxyz1234567890';
	//random string(s) of $a
	$b = '';
	$b1 = 'E253FDH64mUtwubQJZj0xnhgdLBVoNPcWiayslXfRO9vI1C7qGMSTAerz8pY';
	$b2 = 'm3pwHtofxy1hJEU0OdBNWXaC9eAQSrbjFvq2g58cT46nsRIV7MizGLuPYZlD';
	$b3 = 'tbSGZTlecndWof4iavNpRrL8AgV61XP7CQ25myMh3s0JzFIqHUwuEDOBYxj9';
	$b4 = 'WoVywLCH48SEG1vFADBgOmfPYQirdtzaMlh970xTRJbe2s5cIXZpnu3qNU6j';
	$b5 = 'trLMwYDxliSaHv5yPFVzTJGQ9oU7huqcN31jOeR6gp4C8AIbf2XEB0sdmnWZ';
	$b6 = 'HwsWy9VDYmJgQML6EPzCtOhRAnx504TaIZi37vjrdNcGoeuBqXFpSb18flU2';
	$b7 = 'qQUs7XGfV9MaBCgJ1ONdT8mijwrA0y6nWLeHF4Zutv3EoPDbSphc52xlYzIR';
	$b8 = 'Zeb5xIt3F0WBnNczRyOQd1P2rmaAoh9X84q6DvH7YjpslCJLUgTufSVMEiGw';
	$b9 = 'DeSlM0oOmWshERVpfzZjANUabYqCdrtByI6u2G9gTJHn5QFv3X1Px8i7L4cw';
	$b10 = 'suOiA7DvbeyWoNrtCY0qZPg8GHzdSJwcx9R2aM356Vm4pBLUlnXjTQhIEFf1';
	$b11 = 'RWdnYNtwmyTAvlV2isaJgIEMr0xOjf3PDuo8hGX1SQ7FCBe5HzqcL96UbZ4p';
	$b12 = 'fdIE9D6C0ZPbVu1QT5Jol4LzxUMGsiqYR8OyHvNASgtpjXWeFw3cBm7nhar2';
	$b13 = 'dt6mByECvTSHi3ZuaQY0r2zwfVqOpAlN9xgW5jo4R7FGhXsJIce8nb1MUDLP';
	$b14 = 'i94SZDLYs6NeRXmap8VhGI1rJWvg0PBf7bFjOtxuwEnT5Q2qdy3colzCAHMU';
	$b15 = 'lJ7BP2poegn9mSdDrbQjTvIY3LiXNExAwRU1GOMa4f5tc8HsFuZhVW06zqCy';
	$b16 = 'lTL5dO3RCQG2htiS86aYyPEgNr94z7csenBqm1fUXJxbZWIFDVHwvjoMA0up';
	$b17 = 'VQqfH3MBDWAlaOs6G1cyxCNSXdvgziJp2FhUTr5neEPZYw4jm9L08IboRut7';
	$b18 = 'O908Yw7GrmfZS4PhETpCtuqU621WJAnclaovjNyBzR5IiMQxbDeHLX3dFgVs';
	$b19 = 'eXYHSDEpVZ9GbisU42x1nRlj605Oz7f8qMCAJWhmroNTvwLutd3BIgPFycQa';
	$b20 = 'LHMYcAjp9goFQWyRCbzm74EVUBf1tqerwNDS8viZx2nO5lIJXTd06uhPG3as';
	$b21 = 'xTRUWJ9swzl5E1Mr6C4fepDGbmqPvIuy2FB7aocAOtVniZ8jX0dQHYSLgN3h';
	$b22 = 'EvSupAHtT91sdfizyqDBcgLJYnaM40hxjG3meRWrVI7O26ZPQFwNCUXo5bl8';
	$b23 = '3z75emaWrNRsfjIGgCHbF26ZBUDVhuAiJ4Mtnpc19LSYPlEdQO8y0vqTxowX';
	$b24 = 'x4IG1RhtUdJEpF5r6oSiX0BATZC9v7OWcb38zjfwnHuyqD2NMgsVlameYLQP';
	$b25 = '3i5t6Dr1MbyuZlJTsdfmjC2HVhRPeNcESXIUnOWzvgxBL8woGq74AY90apFQ';
	$b26 = 'e8UtOTbuqvDPmMGiYFX3Swjo7Zh9das6pBg2fxACJl05NEHcQL4rRn1yVzWI';
	$b27 = '4poAOgUPn89qTwsrh2DvGteWlfc1EmuJxVbIB0LS6HCYZMdjiyaQRX5FNz37';
	$b28 = 'dl1Fyo48VuzWt7M3EwbHRDTJvUeqsAXx5L0mQBhOZGC6cYfjpgrSaInPi9N2';
	$b29 = 'T5w9s7iIrmLpYOzjnfJUlF6ybS3D1HaMBPqd8Ee4ACoQc0WtvZuNhGxR2gVX';
	$b30 = 'jrex0G2yNq7WbctDis9J4AhvBX3LESIQOnudVga6pPFCMoR8fUTzm1lZH5wY';
	//list of key pairs
	$c = 'A=01 B=02 C=03 D=04 E=05 F=06 G=07 H=08 I=09 J=10 L=11 M=12 N=13 O=14 P=15 Q=16 R=17 S=18 T=19 U=20 V=21 W=22 X=23 Y=24 Z=25 a=26 b=27 c=28 d=29 e=30 f=31 g=32 h=33 i=34 j=35 l=36 m=37 n=38 o=39 p=40 q=41 r=42 s=43 t=44 u=45 v=46 w=47 x=48 y=49 z=50 1=51 2=52 3=53 4=54 5=55 6=56 7=57 8=58 9=59 0=60';
	//compression stuff
	$d = '00=a 11=b 22=c 33=d 44=e 55=f 66=g 77=h 88=i 99=j';
	
	function encrypt($str, $ca) {
		//begin
		$final = '';
		$temp = '';
		//define globals
		global $a; global $b; global $c; global $d;
		//set CA
		$b = CAint($ca);
		//step 1:
		$arr = str_split($str);
		foreach ($arr as $char) {
			$loop = 0;
			$arr2 = str_split($a);
			foreach ($arr2 as $char2) {
				if ($char == $char2) {
					$temp .= $b[$loop];
					break;
				}
				$loop += 1;
			}
		}
		$final = $temp; $temp = ''; //save
		//step 2:
		$arr = str_split($final);
		foreach ($arr as $char) {
			$arr2 = explode(' ', $c);
			foreach ($arr2 as $pair) {
				$arr = explode('=', $pair);
				$key = $arr[0]; $val = $arr[1];
				if ($char == $key) {
					$temp .= $val;
					break;
				}
			}
		}
		$final = $temp; $temp = ''; //save
		//step 3:
		$arr2 = explode(' ', $d);
		$temp = $final;
		foreach ($arr2 as $pair) {
			$arr = explode('=', $pair);
			$key = $arr[0]; $val = $arr[1];
			$temp = str_replace($key, $val, $temp);
		}
		$final = $temp; $temp = ''; //save
		//step 4:
		$rf = strrev($final);
		for ($i = 0; $i < strlen($rf); $i+=2) {
			$temp .= $rf[$i+1].$rf[$i];
		}
		$final = $temp; $temp = ''; //save
		//end
		return $final;
	}
	
	function decrypt($str, $ca) {
		//begin
		$final = '';
		$temp = '';
		//define globals
		global $a; global $b; global $c; global $d;
		//set CA
		$b = CAint($ca);
		//step 1:
		for ($i = 0; $i < strlen($str); $i+=2) {
			$temp .= $str[$i+1].$str[$i];
		}
		$temp = strrev($temp);
		$final = $temp; $temp = ''; //save
		//step 2:
		$arr2 = explode(' ', $d);
		$temp = $final;
		foreach ($arr2 as $pair) {
			$arr = explode('=', $pair);
			$key = $arr[1]; $val = $arr[0];
			$temp = str_replace($key, $val, $temp);
		}
		
		//end
		return $final;
	}
	
	
	function CAint($i) {
		$b = '';
		global $b1; global $b2; global $b3; global $b4; global $b5;
		global $b6; global $b7; global $b8; global $b9; global $b10;
		global $b11; global $b12; global $b13; global $b14; global $b15;
		global $b16; global $b17; global $b18; global $b19; global $b20;
		global $b21; global $b22; global $b23; global $b24; global $b25;
		global $b26; global $b27; global $b28; global $b29; global $b30;
		if ($i == 1) { $b = $b1; }
		if ($i == 2) { $b = $b2; }
		if ($i == 3) { $b = $b3; }
		if ($i == 4) { $b = $b4; }
		if ($i == 5) { $b = $b5; }
		if ($i == 6) { $b = $b6; }
		if ($i == 7) { $b = $b7; }
		if ($i == 8) { $b = $b8; }
		if ($i == 9) { $b = $b9; }
		if ($i == 10) { $b = $b10; }
		if ($i == 11) { $b = $b11; }
		if ($i == 12) { $b = $b12; }
		if ($i == 13) { $b = $b13; }
		if ($i == 14) { $b = $b14; }
		if ($i == 15) { $b = $b15; }
		if ($i == 16) { $b = $b16; }
		if ($i == 17) { $b = $b17; }
		if ($i == 18) { $b = $b18; }
		if ($i == 19) { $b = $b19; }
		if ($i == 20) { $b = $b20; }
		if ($i == 21) { $b = $b21; }
		if ($i == 22) { $b = $b22; }
		if ($i == 23) { $b = $b23; }
		if ($i == 24) { $b = $b24; }
		if ($i == 25) { $b = $b25; }
		if ($i == 26) { $b = $b26; }
		if ($i == 27) { $b = $b27; }
		if ($i == 28) { $b = $b28; }
		if ($i == 29) { $b = $b29; }
		if ($i == 30) { $b = $b30; }
		return $b;
	}
	
?>